define("static/scripts/index/company/company_list",["sea-modules/bootstrap/bootstrap","sea-modules/jquery/cookie/jquery.cookie","static/scripts/index/company/company_form","static/scripts/index/message","static/scripts/index/datatable","sea-modules/jquery/dialog/jquery.dialog","static/scripts/index/uploadify"],function(t,a,o){o.exports=function(a){t("sea-modules/bootstrap/bootstrap"),t("sea-modules/jquery/cookie/jquery.cookie");var o=$.cookie("bizData"),e=t("static/scripts/index/company/company_form"),n=t("static/scripts/index/message"),c=t("static/scripts/index/datatable"),i=[{data:"companyId"},{data:"companyName",title:"公司名称"},{data:"companyLogo",title:"公司logo"},{data:"companyAddress",title:"公司地址"},{data:"zipCode",title:"邮政编码"},{data:"contactPhone",title:"联系电话"},{data:"contactFax",title:"传真"},{data:"contactPerson",title:"联系人"},{data:"companyEmail",title:"电子邮件"},{data:"loginNumber",title:"管理员"},{data:"userName",title:"真实姓名"}],s=[{bVisible:!1,aTargets:[0]},{aTargets:[2],sWidth:"18px",render:function(t){return'<img src="'+t+'" width="18" height="18" />'}},{aTargets:[3],render:function(t){return'<a style="color:#fff;text-decoration:underline" href="'+t+'" target="_blank">'+t+"</a>"}},{aTargets:[8],render:function(t){return'<a style="color:#fff;text-decoration:underline" href="Mailto:'+t+'">'+t+"</a>"}}];c.initTable({columns:i,tableContentId:"menu_table_content",tableId:"company_table_body",columnDefs:s,sAjaxSource:"/system/company/queryCompany?productCode="+a+"&token="+o});var d=c.dataTable,l={add:function(c){$("#"+c).off("click"),$("#"+c).on("click",function(){d&&$.get("../tmpl/company/company_form.html",function(c){t("sea-modules/jquery/dialog/jquery.dialog"),$("#add_company").dialog({title:"新增公司",tmpl:c,onClose:function(){$("#add_company").dialog("destroy")},render:function(){setTimeout(function(){var a=t("static/scripts/index/uploadify");a(function(t,a){var o=JSON.parse(a);200==o.code&&($("#company_logo_img").attr("src",o.data.url),$("#company_logo").val(o.data.url))})},100)},buttons:[{text:"下一步","class":"btn btn-success step-1",click:function(){e.validateTheFirstStep(function(){var t=$(".modal-footer button.btn-success"),a=$(".modal-footer button.add");if(t.hasClass("step-1")){t.removeClass("step-1"),t.addClass("step-2"),t.html("上一步"),$("#step_title_1").removeClass("focus"),$("#step_title_2").addClass("focus");var o=$("#page_body").width()/2;a.show(),$("#page_body").animate({left:-o+"px"})}else t.hasClass("step-2")&&(t.removeClass("step-2"),t.addClass("step-1"),t.html("下一步"),$("#step_title_2").removeClass("focus"),$("#step_title_1").addClass("focus"),a.hide(),$("#page_body").animate({left:"0px"}))})}},{text:"新增","class":"btn btn-primary add custom-hide",click:function(){e.validateTheSecondStep(function(t){var e={productCode:a,companyName:t[0]||"",companyShortName:t[1]||"",companyLogo:t[3]||"",companyAddress:t[2]||"",zipCode:t[4]||"",contactPhone:t[5]||"",contactFax:t[6]||"",contactPerson:t[7]||"",companyEmail:t[8]||"",userName:t[9]||"",loginNumber:t[10]||"",password:t[11]||"",phone:t[12]||"",email:t[13]||""};$.ajax({type:"post",url:"/system/company/addOrEditCompany?token="+o,contentType:"application/x-www-form-urlencoded;charset=UTF-8",data:{companyJson:JSON.stringify(e)},dataType:"json",success:function(t){"0000000"===t.rtnCode?(d.fnDraw(),$("#add_company").dialog("destroy")):($("#add_company").dialog("destroy"),n({title:"温馨提示",msg:t.msg,type:"alert",clickHandle:function(){"0100014"===t.rtnCode&&(window.location.href="login.html")}}))},beforeSend:function(){},error:function(){}})})}},{text:"取消","class":"btn btn-primary",click:function(){$("#add_company").dialog("destroy")}}]})})})},update:function(a){$("#"+a).off("click"),$("#"+a).on("click",function(){if(d){var a=c.fnGetSelected(d);if(0!==a.length){var i=d.fnGetData(a[0]);$.get("/system/company/getCompany?id="+i.companyId+"&token="+o,function(a){"0000000"===a.rtnCode&&$.get("../tmpl/company/update_company.html",function(c){t("sea-modules/jquery/dialog/jquery.dialog"),$("#add_company").dialog({title:"修改代理公司",tmpl:c,onClose:function(){$("#add_company").dialog("destroy")},render:function(){setTimeout(function(){var a=t("static/scripts/index/uploadify");a(function(t,a){var o=JSON.parse(a);200==o.code&&($("#company_logo_img").attr("src",o.data.url),$("#company_logo").val(o.data.url))})},100),$("#company_name").val(a.bizData.companyName),$("#company_abbreviation").val(a.bizData.companyShortName),$("#company_address").val(a.bizData.companyAddress),$("#company_logo").val(a.bizData.companyLogo),$("#company_logo_img").attr("src",a.bizData.companyLogo),$("#post_code").val(a.bizData.zipCode),$("#telephone").val(a.bizData.contactPhone),$("#fax").val(a.bizData.contactFax),$("#contacts").val(a.bizData.contactPerson),$("#e_mail").val(a.bizData.email)},buttons:[{text:"修改","class":"btn btn-primary",click:function(){e.validateTheFirstStep(function(t){var a={companyId:i.id,companyName:t[0]||"",companyShortName:t[1]||"",companyLogo:t[3]||"",companyAddress:t[2]||"",zipCode:t[4]||"",contactPhone:t[5]||"",contactFax:t[6]||"",contactPerson:t[7]||"",companyEmail:t[8]||"",description:t[9]||""};$.ajax({type:"post",url:"/system/company/addOrEditCompany?token="+o,contentType:"application/x-www-form-urlencoded;charset=UTF-8",data:{companyJson:JSON.stringify(a)},dataType:"json",success:function(t){"0000000"===t.rtnCode?(d.fnDraw(),$("#add_company").dialog("destroy")):n({title:"温馨提示",msg:t.msg,type:"alert",clickHandle:function(){window.location.href="login.html"}})},beforeSend:function(){},error:function(){}})})}},{text:"取消","class":"btn btn-primary",click:function(){$("#add_company").dialog("destroy")}}]})})})}}})},"delete":function(t){$("#"+t).off("click"),$("#"+t).on("click",function(){if(d){var t=c.fnGetSelected(d);if(0!==t.length){var a=d.fnGetData(t[0]),e="确认删除代理公司"+a.companyName;n({title:"温馨提示",msg:e,type:"alert",clickHandle:function(){$.get("/system/company/delCompany?id="+a.companyId+"&token="+o,function(t){"0000000"===t.rtnCode?d.fnDraw():n({title:"错误提示",msg:t.msg,type:"alert"})})}})}}})}};t.async(["static/scripts/index/renderResource"],function(t){t(l,o)})}});