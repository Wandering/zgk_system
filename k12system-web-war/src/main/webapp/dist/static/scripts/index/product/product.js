define("static/scripts/index/product/product",["sea-modules/bootstrap/bootstrap","sea-modules/jquery/cookie/jquery.cookie","static/scripts/index/message","static/scripts/index/product/product_form","static/scripts/index/datatable","static/scripts/index/uploadify","sea-modules/jquery/dialog/jquery.dialog"],function(t,e,o){o.exports=function(){t("sea-modules/bootstrap/bootstrap"),t("sea-modules/jquery/cookie/jquery.cookie");var e=$.cookie("bizData"),o=t("static/scripts/index/message"),a=t("static/scripts/index/product/product_form"),d=t("static/scripts/index/datatable"),r=[{data:"productId"},{data:"productName",title:"产品名称"},{data:"productIndexPage",title:"产品地址"},{data:"productLogo",title:"产品logo"},{data:"description",title:"产品描述"},{data:"loginNumber",title:"管理员"},{data:"userName",title:"真实姓名"}],c=[{bVisible:!1,aTargets:[0]},{aTargets:[2],render:function(t){return'<a style="color:#fff;text-decoration:underline" href="'+t+'" target="_blank">'+t+"</a>"}},{aTargets:[3],render:function(t){return'<img src="'+t+'" width="18" height="18" />'}},{aTargets:[4],render:function(t){var e=t;return e.length>40&&(e=t.substring(0,40)+'...<a class="row-details row-details-close">更多</a>'),e}}];d.initTable({columns:r,tableContentId:"table_content",tableId:"product_table_body",columnDefs:c,sAjaxSource:"/system/product/queryProduct?token="+e});var i=d.dataTable,n=function(){var e=t("static/scripts/index/uploadify");e(function(t,e){var o=JSON.parse(e);200==o.code&&($("#product_logo_img").attr("src",o.data.url),$("#product_logo").val(o.data.url))})},s={add:function(d){$("#"+d).off("click"),$("#"+d).on("click",function(){i&&$.get("../tmpl/product/add_product.html",function(d){t("sea-modules/jquery/dialog/jquery.dialog"),$("#add_product").dialog({title:"新增产品",tmpl:d,onClose:function(){$("#add_product").dialog("destroy")},render:function(){setTimeout(function(){n()},100)},buttons:[{text:"下一步","class":"btn btn-success step-1",click:function(){a.validateTheFirstStep(function(){var t=$(".modal-footer button.btn-success"),e=$(".modal-footer button.add");if(t.hasClass("step-1")){t.removeClass("step-1"),t.addClass("step-2"),t.html("上一步"),$("#step_title_1").removeClass("focus"),$("#step_title_2").addClass("focus");var o=$("#page_body").width()/2;e.show(),$("#page_body").animate({left:-o+"px"})}else t.hasClass("step-2")&&(t.removeClass("step-2"),t.addClass("step-1"),t.html("下一步"),$("#step_title_2").removeClass("focus"),$("#step_title_1").addClass("focus"),e.hide(),$("#page_body").animate({left:"0px"}))})}},{text:"新增","class":"btn btn-primary add custom-hide",click:function(){a.validateTheSecondStep(function(t){var a={productName:t[0],productIndexPage:t[1],addressJson:t[1],productLogo:t[2],description:t[3],userName:t[4],loginNumber:t[5],password:t[6],phone:t[7],email:t[8]};$.ajax({type:"post",url:"/system/product/addOrEditProduct?token="+e,contentType:"application/x-www-form-urlencoded;charset=UTF-8",data:{productJson:JSON.stringify(a)},dataType:"json",success:function(t){"0000000"===t.rtnCode?(i.fnDraw(),$("#add_product").dialog("destroy")):($("#add_product").dialog("destroy"),o({title:"温馨提示",msg:t.msg,type:"alert",clickHandle:function(){window.location.href="login.html"}}))},beforeSend:function(){},error:function(){}})})}},{text:"取消","class":"btn btn-primary",click:function(){$("#add_product").dialog("destroy")}}]})})})},update:function(r){$("#"+r).off("click"),$("#"+r).on("click",function(){if(i){var r=d.fnGetSelected(i);if(0!==r.length){var c=i.fnGetData(r[0]);$.get("/system/product/getProduct?id="+c.productId+"&token="+e,function(d){"0000000"===d.rtnCode&&$.get("../tmpl/product/update_product.html",function(r){t("sea-modules/jquery/dialog/jquery.dialog"),$("#add_product").dialog({title:"修改产品",tmpl:r,onClose:function(){$("#add_product").dialog("destroy")},render:function(){setTimeout(function(){n()},100),$("#product_name").val(d.bizData.productName),$("#product_url").val(d.bizData.productIndexPage),$("#product_logo").val(d.bizData.productLogo),$("#product_logo_img").attr("src",d.bizData.productLogo),$("#product_describe").val(d.bizData.description)},buttons:[{text:"修改","class":"btn btn-primary",click:function(){a.validateTheFirstStep(function(t,a,d,r){var n={productId:c.id,addressJson:a,description:r,productIndexPage:a,productLogo:d,productName:t};$.ajax({type:"post",url:"/system/product/addOrEditProduct?token="+e,contentType:"application/x-www-form-urlencoded;charset=UTF-8",data:{productJson:JSON.stringify(n)},dataType:"json",success:function(t){"0000000"===t.rtnCode?(i.fnDraw(),$("#add_product").dialog("destroy")):($("#add_product").dialog("destroy"),o({title:"温馨提示",msg:t.msg,type:"alert",clickHandle:function(){window.location.href="login.html"}}))},beforeSend:function(){},error:function(){}})})}},{text:"取消","class":"btn btn-primary",click:function(){$("#add_product").dialog("destroy")}}]})})})}}})},"delete":function(t){$("#"+t).off("click"),$("#"+t).on("click",function(){if(i){var t=d.fnGetSelected(i);if(0!==t.length){var a=i.fnGetData(t[0]),r="确认删除产品"+a.productName;o({title:"温馨提示",msg:r,clickHandle:function(){$.get("/system/product/delProduct?id="+a.productId+"&token="+e,function(t){"0000000"===t.rtnCode?i.fnDraw():o({title:"错误提示",msg:t.msg,type:"alert"})})}})}}})}};t.async(["static/scripts/index/renderResource"],function(t){t(s,e)})}});