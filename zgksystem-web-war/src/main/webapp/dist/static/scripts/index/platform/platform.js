define("static/scripts/index/platform/platform",["sea-modules/bootstrap/bootstrap","sea-modules/jquery/cookie/jquery.cookie","static/scripts/index/message","static/scripts/index/platform/platform_form","static/scripts/index/datatable","static/scripts/index/uploadify","sea-modules/jquery/dialog/jquery.dialog"],function(t,e,a){a.exports=function(){t("sea-modules/bootstrap/bootstrap"),t("sea-modules/jquery/cookie/jquery.cookie");var e=$.cookie("bizData"),a=t("static/scripts/index/message"),s=t("static/scripts/index/platform/platform_form"),o=t("static/scripts/index/datatable"),n=[{data:"id"},{data:"systemName",title:"平台名称"},{data:"systemUrl",title:"平台地址"},{data:"systemLogo",title:"平台logo"},{data:"loginNumber",title:"管理员"},{data:"userName",title:"真实姓名"}],i=[{bVisible:!1,aTargets:[0]},{aTargets:[2],render:function(t){return'<a target="_blank" href="'+t+'" style="color:#fff">'+t+"</a>"}},{aTargets:[3],render:function(t){return'<img src="'+t+'" width="18" height="18" />'}}];o.initTable({columns:n,tableContentId:"table_content",tableId:"table_body",columnDefs:i,sAjaxSource:"/system/system/querySystemPage?token="+e});var r=o.dataTable,l=function(){var e=t("static/scripts/index/uploadify");e(function(t,e){var a=JSON.parse(e);200==a.code&&($("#platform_logo_img").attr("src",a.data.url),$("#platform_logo").val(a.data.url))})},d={add:function(o){$("#"+o).off("click"),$("#"+o).on("click",function(){r&&$.get("../tmpl/platform/add_platform.html",function(o){t("sea-modules/jquery/dialog/jquery.dialog"),$("#add_platform").dialog({title:"新增平台",tmpl:o,onClose:function(){$("#add_platform").dialog("destroy")},render:function(){setTimeout(function(){l()},100)},buttons:[{text:"下一步","class":"btn btn-success step-1",click:function(){s.validateTheFirstStep(function(){var t=$(".modal-footer button.btn-success"),e=$(".modal-footer button.add");if(t.hasClass("step-1")){t.removeClass("step-1"),t.addClass("step-2"),t.html("上一步"),$("#step_title_1").removeClass("focus"),$("#step_title_2").addClass("focus");var a=$("#page_body").width()/2;e.show(),$("#page_body").animate({left:-a+"px"})}else t.hasClass("step-2")&&(t.removeClass("step-2"),t.addClass("step-1"),t.html("下一步"),$("#step_title_2").removeClass("focus"),$("#step_title_1").addClass("focus"),e.hide(),$("#page_body").animate({left:"0px"}))})}},{text:"新增","class":"btn btn-primary add custom-hide",click:function(){s.validateTheSecondStep(function(t,s,o,n,i,l,d,c,m){var f={systemName:t,systemUrl:s,systemLogo:o,description:n,loginNumber:i,password:l,userName:d,email:m,phone:c};$.ajax({type:"post",url:"/system/system/addOrEditSytem?token="+e,contentType:"application/x-www-form-urlencoded;charset=utf-8",data:{systemJson:JSON.stringify(f)},dataType:"json",success:function(t){"0000000"===t.rtnCode?(r.fnDraw(),$("#add_platform").dialog("destroy")):($("#add_platform").dialog("destroy"),a({title:"温馨提示",msg:t.msg,type:"alert",clickHandle:function(){"0100014"===t.rtnCode&&(window.location.href="login.html")}}))},beforeSend:function(){},error:function(){}})})}},{text:"取消","class":"btn btn-primary",click:function(){$("#add_platform").dialog("destroy")}}]})})})},update:function(n){$("#"+n).off("click"),$("#"+n).on("click",function(){if(r){var n=o.fnGetSelected(r);if(0!==n.length){var i=r.fnGetData(n[0]);$.get("/system/system/getK12System?systemId="+i.systemId+"&token="+e,function(o){"0000000"===o.rtnCode&&$.get("../tmpl/platform/update_platform.html",function(n){t("sea-modules/jquery/dialog/jquery.dialog"),$("#add_platform").dialog({title:"修改平台",tmpl:n,onClose:function(){$("#add_platform").dialog("destroy")},render:function(){setTimeout(function(){l()},100),$("#platform_name").val(o.bizData.systemName),$("#platform_url").val(o.bizData.systemUrl),$("#platform_logo").val(o.bizData.systemLogo),$("#platform_logo_img").attr("src",o.bizData.systemLogo),$("#platform_describe").val(o.bizData.description)},buttons:[{text:"修改","class":"btn btn-primary",click:function(){s.validateTheFirstStep(function(t,s,o,n){var l={systemId:i.systemId,systemName:t,systemUrl:s,systemLogo:o,description:n};$.ajax({type:"post",url:"/system/system/addOrEditSytem?token="+e,contentType:"application/x-www-form-urlencoded;charset=utf-8",data:{systemJson:JSON.stringify(l)},dataType:"json",success:function(t){"0000000"===t.rtnCode?(r.fnDraw(),$("#add_platform").dialog("destroy")):($("#add_platform").dialog("destroy"),a({title:"温馨提示",msg:t.msg,type:"alert",clickHandle:function(){"0100014"===t.rtnCode&&(window.location.href="login.html")}}))},beforeSend:function(){},error:function(){}})})}},{text:"取消","class":"btn btn-primary",click:function(){$("#add_platform").dialog("destroy")}}]})})})}}})},"delete":function(t){$("#"+t).off("click"),$("#"+t).on("click",function(){if(r){var t=o.fnGetSelected(r);if(0!==t.length){var s=r.fnGetData(t[0]),n="确认删除平台"+s.systemName;a({title:"温馨提示",msg:n,type:"alert",clickHandle:function(){$.ajax({type:"post",url:"/system/system/delSystem?systemId="+s.systemId+"&token="+e,contentType:"application/x-www-form-urlencoded;charset=utf-8",dataType:"json",success:function(t){"0000000"===t.rtnCode?r.fnDraw():a({title:"温馨提示",msg:t.msg,type:"alert"})},beforeSend:function(){},error:function(){}})}})}}})}};t.async(["static/scripts/index/renderResource"],function(t){t(d,e)})}});