define("static/scripts/index/dep/dep_list",["sea-modules/bootstrap/bootstrap","sea-modules/jquery/cookie/jquery.cookie","static/scripts/index/message","static/scripts/index/datatable","sea-modules/jquery/dialog/jquery.dialog","static/scripts/index/dep/dep_form"],function(e,t,a){a.exports=function(t,a){e("sea-modules/bootstrap/bootstrap"),e("sea-modules/jquery/cookie/jquery.cookie");var o=$.cookie("bizData"),n=e("static/scripts/index/message"),i=e("static/scripts/index/datatable"),d=[{data:"id"},{data:"departmentName",title:"部门名称"},{data:"departmentPhone",title:"部门电话"},{data:"departmentFax",title:"部门传真"},{data:"departmentPrincipal",title:"部门负责人"}],r=[{bVisible:!1,aTargets:[0]}];i.initTable({columns:d,tableContentId:"menu_table_content",tableId:(new Date).getTime()+"_table_body",columnDefs:r,sAjaxSource:"/system/department/queryDepartment?parentCode="+t+"&token="+o});var c=i.dataTable,p=function(e,a,n){var i={departmentName:e[0]||"",departmentPhone:e[1]||"",departmentFax:e[2]||"",departmentPrincipal:e[3]||"",departmentProvince:e[4]||"",departmentCity:e[5]||"",departmentCounty:e[6]||""};n?i.id=n:i.parentCode=t,$.ajax({type:"post",url:"/system/department/addOrEditDepartment?token="+o,contentType:"application/x-www-form-urlencoded;charset=UTF-8",data:{departmentJson:JSON.stringify(i)},dataType:"json",success:function(e){console.log(e),a(e)},beforeSend:function(){},error:function(){}})},s={add:function(t){$("#"+t).off("click"),$("#"+t).on("click",function(){c&&$.get("../tmpl/dep/dep_form.html",function(t){e("sea-modules/jquery/dialog/jquery.dialog"),$("#add_dep").dialog({title:"新增部门",tmpl:t,onClose:function(){$("#add_dep").dialog("destroy")},render:function(){var e=JSON.parse($.cookie("userInfo")),t=e.roleType;console.log(e);var a=e.areaCode;switch(t){case 1:$("#dep_provinces_from").show(),$("#dep_city_from,#dep_county_from").hide(),$.getJSON("/system/dataDictionary/findProvinceList?token="+o,function(e){console.log(e);for(var t=0;t<e.bizData.length;t++)$("#dep_provinces").append('<option value="'+e.bizData[t].id+'">'+e.bizData[t].provinceName+"</option>")});break;case 2:a+="0000",$("#dep_city_from").show(),$("#dep_provinces_from,#dep_county_from").hide(),$.getJSON("/system/dataDictionary/findCityList?token="+o+"&provinceId="+a,function(e){console.log(e);for(var t=0;t<e.bizData.length;t++)$("#dep_city").append('<option value="'+e.bizData[t].id+'">'+e.bizData[t].cityName+"</option>")});break;case 3:a+="00",$("#dep_county_from").show(),$("#dep_provinces_from,#dep_city_from").hide(),$.getJSON("/system/dataDictionary/findCountyList?token="+o+"&cityId="+a,function(e){console.log(e);for(var t=0;t<e.bizData.length;t++)$("#dep_county").append('<option value="'+e.bizData[t].id+'">'+e.bizData[t].countyName+"</option>")})}},buttons:[{text:"新增","class":"btn btn-primary",click:function(){var t=e("static/scripts/index/dep/dep_form");t.validate(function(e){p(e,function(t){if("0000000"===t.rtnCode){c.fnDraw();var o={id:t.bizData.departmentCode,name:e[0]};a({type:"add",obj:o}),$("#add_dep").dialog("destroy")}else $("#add_dep").dialog("destroy"),n({title:"温馨提示",msg:t.msg,type:"alert",clickHandle:function(){window.location.href="login.html"}})})})}},{text:"取消","class":"btn btn-primary",click:function(){$("#add_dep").dialog("destroy")}}]})})})},update:function(t){$("#"+t).off("click"),$("#"+t).on("click",function(){if(c){var t=i.fnGetSelected(c);if(0!==t.length){var d=c.fnGetData(t[0]);$.get("/system/department/getDepartment?id="+d.id+"&token="+o,function(t){console.log(t),"0000000"===t.rtnCode&&$.get("../tmpl/dep/dep_form.html",function(i){e("sea-modules/jquery/dialog/jquery.dialog"),$("#add_dep").dialog({title:"修改部门",tmpl:i,onClose:function(){$("#add_dep").dialog("destroy")},render:function(){$("#dep_name").val(t.bizData.departmentName),$("#dep_telephone").val(t.bizData.departmentPhone),$("#dep_fax").val(t.bizData.departmentFax),$("#dep_leading").val(t.bizData.departmentPrincipal);var e=JSON.parse($.cookie("userInfo")),a=e.roleType;console.log(e);var n=e.areaCode;switch(a){case 1:$("#dep_provinces_from").show(),$("#dep_city_from,#dep_county_from").hide(),$.getJSON("/system/dataDictionary/findProvinceList?token="+o,function(e){console.log(e);for(var t=0;t<e.bizData.length;t++)$("#dep_provinces").append('<option value="'+e.bizData[t].id+'">'+e.bizData[t].provinceName+"</option>")});break;case 2:n+="0000",$("#dep_city_from").show(),$("#dep_provinces_from,#dep_county_from").hide(),$.getJSON("/system/dataDictionary/findCityList?token="+o+"&provinceId="+n,function(e){console.log(e);for(var t=0;t<e.bizData.length;t++)$("#dep_city").append('<option value="'+e.bizData[t].id+'">'+e.bizData[t].cityName+"</option>")});break;case 3:n+="00",$("#dep_county_from").show(),$("#dep_provinces_from,#dep_city_from").hide(),$.getJSON("/system/dataDictionary/findCountyList?token="+o+"&cityId="+n,function(e){console.log(e);for(var t=0;t<e.bizData.length;t++)$("#dep_county").append('<option value="'+e.bizData[t].id+'">'+e.bizData[t].countyName+"</option>")})}},buttons:[{text:"修改","class":"btn btn-primary",click:function(){var o=e("static/scripts/index/dep/dep_form");o.validate(function(e){p(e,function(o){if("0000000"===o.rtnCode){c.fnDraw();var i={id:t.bizData.departmentCode,name:e[0]};a({type:"update",obj:i}),$("#add_dep").dialog("destroy")}else $("#add_dep").dialog("destroy"),n({title:"温馨提示",msg:o.msg,type:"alert",clickHandle:function(){window.location.href="login.html"}})},d.id)})}},{text:"取消","class":"btn btn-primary",click:function(){$("#add_dep").dialog("destroy")}}]})})})}}})},"delete":function(e){$("#"+e).off("click"),$("#"+e).on("click",function(){if(c){var e=i.fnGetSelected(c);if(0!==e.length){var t=c.fnGetData(e[0]),d="确认删除部门"+t.departmentName;n({title:"温馨提示",msg:d,type:"alert",clickHandle:function(){$.get("/system/department/delDepartment?id="+t.id+"&token="+o,function(e){"0000000"===e.rtnCode?(c.fnDraw(),a({type:"delete",id:t.departmentCode})):n({title:"错误提示",msg:e.msg,type:"alert"})})}})}}})}};e.async(["static/scripts/index/renderResource"],function(e){e(s,o)})}});