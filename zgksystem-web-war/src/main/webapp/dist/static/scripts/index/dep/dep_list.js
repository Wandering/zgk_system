define("static/scripts/index/dep/dep_list",["sea-modules/bootstrap/bootstrap","sea-modules/jquery/cookie/jquery.cookie","static/scripts/index/message","static/scripts/index/datatable","sea-modules/jquery/dialog/jquery.dialog","static/scripts/index/dep/dep_form"],function(t,e,a){a.exports=function(e,a){t("sea-modules/bootstrap/bootstrap"),t("sea-modules/jquery/cookie/jquery.cookie");var n=$.cookie("bizData"),i=t("static/scripts/index/message"),d=t("static/scripts/index/datatable"),o=[{data:"id"},{data:"departmentName",title:"部门名称"},{data:"departmentPhone",title:"部门电话"},{data:"departmentFax",title:"部门传真"},{data:"departmentPrincipal",title:"部门负责人"}],r=[{bVisible:!1,aTargets:[0]}];d.initTable({columns:o,tableContentId:"menu_table_content",tableId:(new Date).getTime()+"_table_body",columnDefs:r,sAjaxSource:"/system/department/queryDepartment?parentCode="+e+"&token="+n});var c=d.dataTable,l=function(t,a,i){var d={departmentName:t[0]||"",departmentPhone:t[1]||"",departmentFax:t[2]||"",departmentPrincipal:t[3]||"",departmentProvince:t[4]||"",departmentCity:t[5]||"",departmentCounty:t[6]||""};i?d.id=i:d.parentCode=e,$.ajax({type:"post",url:"/system/department/addOrEditDepartment?token="+n,contentType:"application/x-www-form-urlencoded;charset=UTF-8",data:{departmentJson:JSON.stringify(d)},dataType:"json",success:function(t){a(t)},beforeSend:function(){},error:function(){}})},s={add:function(e){$("#"+e).off("click"),$("#"+e).on("click",function(){c&&$.get("../tmpl/dep/dep_form.html",function(e){t("sea-modules/jquery/dialog/jquery.dialog"),$("#add_dep").dialog({title:"新增部门",tmpl:e,onClose:function(){$("#add_dep").dialog("destroy")},render:function(){$.getJSON("/system/dataDictionary/findProvinceList?token="+n,function(t){console.log(t);for(var e=0;e<t.bizData.length;e++)$("#dep_provinces").append('<option value="'+t.bizData[e].id+'">'+t.bizData[e].provinceName+"</option>")}),$("#dep_provinces").change(function(){var t=$(this).find("option:selected").val();$.getJSON("/system/dataDictionary/findCityList?token="+n+"&provinceId="+t,function(t){console.log(t);for(var e=0;e<t.bizData.length;e++)$("#dep_city").append('<option value="'+t.bizData[e].id+'">'+t.bizData[e].cityName+"</option>")})}),$("#dep_city").change(function(){var t=$(this).find("option:selected").val();$.getJSON("/system/dataDictionary/findCountyList?token="+n+"&cityId="+t,function(t){console.log(t);for(var e=0;e<t.bizData.length;e++)$("#dep_county").append('<option value="'+t.bizData[e].id+'">'+t.bizData[e].countyName+"</option>")})})},buttons:[{text:"新增","class":"btn btn-primary",click:function(){var e=t("static/scripts/index/dep/dep_form");e.validate(function(t){l(t,function(e){if("0000000"===e.rtnCode){c.fnDraw();var n={id:e.bizData.departmentCode,name:t[0]};a({type:"add",obj:n}),$("#add_dep").dialog("destroy")}else $("#add_dep").dialog("destroy"),i({title:"温馨提示",msg:e.msg,type:"alert",clickHandle:function(){window.location.href="login.html"}})})})}},{text:"取消","class":"btn btn-primary",click:function(){$("#add_dep").dialog("destroy")}}]})})})},update:function(e){$("#"+e).off("click"),$("#"+e).on("click",function(){if(c){var e=d.fnGetSelected(c);if(0!==e.length){var o=c.fnGetData(e[0]);$.get("/system/department/getDepartment?id="+o.id+"&token="+n,function(e){console.log(e),"0000000"===e.rtnCode&&$.get("../tmpl/dep/dep_form.html",function(n){t("sea-modules/jquery/dialog/jquery.dialog"),$("#add_dep").dialog({title:"修改部门",tmpl:n,onClose:function(){$("#add_dep").dialog("destroy")},render:function(){$("#dep_name").val(e.bizData.departmentName),$("#dep_telephone").val(e.bizData.departmentPhone),$("#dep_fax").val(e.bizData.departmentFax),$("#dep_leading").val(e.bizData.departmentPrincipal)},buttons:[{text:"修改","class":"btn btn-primary",click:function(){var n=t("static/scripts/index/dep/dep_form");n.validate(function(t){l(t,function(n){if("0000000"===n.rtnCode){c.fnDraw();var d={id:e.bizData.departmentCode,name:t[0]};a({type:"update",obj:d}),$("#add_dep").dialog("destroy")}else $("#add_dep").dialog("destroy"),i({title:"温馨提示",msg:n.msg,type:"alert",clickHandle:function(){window.location.href="login.html"}})},o.id)})}},{text:"取消","class":"btn btn-primary",click:function(){$("#add_dep").dialog("destroy")}}]})})})}}})},"delete":function(t){$("#"+t).off("click"),$("#"+t).on("click",function(){if(c){var t=d.fnGetSelected(c);if(0!==t.length){var e=c.fnGetData(t[0]),o="确认删除部门"+e.departmentName;i({title:"温馨提示",msg:o,type:"alert",clickHandle:function(){$.get("/system/department/delDepartment?id="+e.id+"&token="+n,function(t){"0000000"===t.rtnCode?(c.fnDraw(),a({type:"delete",id:e.departmentCode})):i({title:"错误提示",msg:t.msg,type:"alert"})})}})}}})}};t.async(["static/scripts/index/renderResource"],function(t){t(s,n)})}});