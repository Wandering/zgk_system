define("static/scripts/index/dep/dep_list",["sea-modules/bootstrap/bootstrap","sea-modules/jquery/cookie/jquery.cookie","static/scripts/index/message","static/scripts/index/datatable","sea-modules/jquery/dialog/jquery.dialog","static/scripts/index/dep/dep_form"],function(e,t,a){a.exports=function(t,a){e("sea-modules/bootstrap/bootstrap"),e("sea-modules/jquery/cookie/jquery.cookie");var o=$.cookie("bizData"),r=e("static/scripts/index/message"),i=e("static/scripts/index/datatable"),d=JSON.parse($.cookie("userInfo")),n=d.roleType;if("1"==n){var c=[{data:"id",title:"序列"},{data:"departmentName",title:"名称"},{data:"roleType",title:"类型"},{data:"departmentPrincipal",title:"负责人"},{data:"departmentPhone",title:"电话"},{data:"goodsAddress",title:"联系地址"},{data:"products",title:"种类",render:function(e,t,a){for(var o="",r=0;r<a.products.length;r++)o+="<div>"+a.products[r].productName+"</div>";return o}},{data:"webPrice",title:"进货价",render:function(e,t,a){for(var o="",r=0;r<a.products.length;r++)o+="<div>"+a.products[r].pickupPrice+"</div>";return o}},{data:"salePrice",title:"售价",render:function(e,t,a){for(var o="",r=0;r<a.products.length;r++)o+="<div>"+a.products[r].salePrice+"</div>";return o}}],s=[{bVisible:!1,sClass:"center",aTargets:[0],render:function(e,t,a){console.log(e),console.log(a)}},{sClass:"line50 center",aTargets:[1]},{aTargets:[2],sClass:"line50 center",render:function(e){var t=["管理员","省级代理","市级代理","区县级代理"];return t[e-1]}},{sClass:"line50 center",aTargets:[3]},{sClass:"line50 center",aTargets:[4]},{sClass:"line50 center",aTargets:[5]},{sClass:"center",aTargets:[6]},{sClass:"center",aTargets:[7]},{sClass:"center",aTargets:[8]}];i.initTable({columns:c,tableContentId:"menu_table_content",tableId:(new Date).getTime()+"_table_body",columnDefs:s,sAjaxSource:"/system/department/queryDepartment?parentCode="+t+"&token="+o});var p=i.dataTable}else{var c=[{data:"id",title:"序列"},{data:"departmentName",title:"名称"},{data:"roleType",title:"类型"},{data:"departmentPrincipal",title:"负责人"},{data:"departmentPhone",title:"电话"},{data:"goodsAddress",title:"联系地址"},{data:"products",title:"种类",render:function(e,t,a){for(var o="",r=0;r<a.products.length;r++)o+="<div>"+a.products[r].productName+"</div>";return o}},{data:"webPrice",title:"进货价",render:function(e,t,a){for(var o="",r=0;r<a.products.length;r++)o+="<div>"+a.products[r].pickupPrice+"</div>";return o}}],s=[{bVisible:!1,sClass:"center",aTargets:[0],render:function(e,t,a){console.log(e),console.log(a)}},{sClass:"line50 center",aTargets:[1]},{sClass:"line50 center",aTargets:[2],render:function(e){var t=["管理员","省级代理","市级代理","区县级代理"];return t[e-1]}},{sClass:"line50 center",aTargets:[3]},{sClass:"line50 center",aTargets:[4]},{sClass:"line50 center",aTargets:[5]},{sClass:"center",aTargets:[6]},{sClass:"center",aTargets:[7]}];i.initTable({columns:c,tableContentId:"menu_table_content",tableId:(new Date).getTime()+"_table_body",columnDefs:s,sAjaxSource:"/system/department/queryDepartment?parentCode="+t+"&token="+o});var p=i.dataTable}var l=function(e,a){var r={departmentName:e[0]||"",departmentPhone:e[1]||"",departmentFax:e[2]||"",departmentPrincipal:e[3]||""};switch(r.parentCode=t,r.goodsAddress=e[5]||"",n){case 1:r.areaCode=e[4]||"";var i=[{salePrice:e[7]||"",pickupPrice:e[6]||"",productId:1,productName:"金榜登科"},{salePrice:e[9]||"",pickupPrice:e[8]||"",productId:3,productName:"金榜提名"},{salePrice:e[11]||"",pickupPrice:e[10]||"",productId:2,productName:"状元及第"}];r.products=i;break;case 2:r.areaCode=e[4];var d=[{salePrice:"",pickupPrice:e[6],productId:1,productName:"金榜登科"},{salePrice:"",pickupPrice:e[7],productId:3,productName:"金榜提名"},{salePrice:"",pickupPrice:e[8],productId:2,productName:"状元及第"}];r.products=d;break;case 3:r.areaCode=e[4];var c=[{salePrice:"",pickupPrice:e[6],productId:1,productName:"金榜登科"},{salePrice:"",pickupPrice:e[7],productId:3,productName:"金榜提名"},{salePrice:"",pickupPrice:e[8],productId:2,productName:"状元及第"}];r.products=c}console.log(r),$.ajax({type:"post",url:"/system/department/addDepartment?token="+o,contentType:"application/x-www-form-urlencoded;charset=UTF-8",data:{departmentJson:JSON.stringify(r)},dataType:"json",success:function(e){console.log(e),a(e)},beforeSend:function(){$(".single-buttons").attr("disabled","disabled")},complete:function(){$(".single-buttons").removeAttr("disabled")},error:function(){}})},u=function(e,t,a){var r={departmentName:e[0]||"",departmentPhone:e[1]||"",departmentFax:e[2]||"",departmentPrincipal:e[3]||""};switch(r.id=a,r.goodsAddress=e[5]||"",n){case 1:r.areaCode=e[4]||"";var i=[{salePrice:e[7]||"",pickupPrice:e[6]||"",productId:1,productName:"金榜登科"},{salePrice:e[9]||"",pickupPrice:e[8]||"",productId:3,productName:"金榜提名"},{salePrice:e[11]||"",pickupPrice:e[10]||"",productId:2,productName:"状元及第"}];r.products=i;break;case 2:r.areaCode=e[4];var d=[{salePrice:"",pickupPrice:e[6],productId:1,productName:"金榜登科"},{salePrice:"",pickupPrice:e[7],productId:3,productName:"金榜提名"},{salePrice:"",pickupPrice:e[8],productId:2,productName:"状元及第"}];r.products=d;break;case 3:r.areaCode=e[4];var c=[{salePrice:"",pickupPrice:e[6],productId:1,productName:"金榜登科"},{salePrice:"",pickupPrice:e[7],productId:3,productName:"金榜提名"},{salePrice:"",pickupPrice:e[8],productId:2,productName:"状元及第"}];r.products=c}console.log(r),$.ajax({type:"post",url:"/system/department/updateDepartment?token="+o,contentType:"application/x-www-form-urlencoded;charset=UTF-8",data:{departmentJson:JSON.stringify(r)},dataType:"json",success:function(e){console.log(e),t(e)},beforeSend:function(){$(".single-buttons").attr("disabled","disabled")},complete:function(){$(".single-buttons").removeAttr("disabled")},error:function(){}})},m={add:function(t){$("#"+t).off("click"),$("#"+t).on("click",function(){p&&$.get("../tmpl/dep/dep_form.html",function(t){e("sea-modules/jquery/dialog/jquery.dialog"),$("#add_dep").dialog({title:"新增代理商",tmpl:t,onClose:function(){$("#add_dep").dialog("destroy")},render:function(){var e=JSON.parse($.cookie("userInfo")),t=parseInt(e.roleType),a=e.areaCode;switch(console.log(a),console.log(t),t){case 1:$("#dep_provinces_from").show(),$("#dep_city_from,#dep_county_from").hide(),$.getJSON("/system/dataDictionary/findProvinceList?token="+o,function(e){console.log(e);for(var t=0;t<e.bizData.length;t++)$("#dep_provinces").append('<option value="'+e.bizData[t].id+'">'+e.bizData[t].provinceName+"</option>")});break;case 2:a+="0000",$("#dep_city_from").show(),$("#dep_provinces_from,#dep_county_from,#products1-control,#products2-control,#products3-control").hide(),$.getJSON("/system/dataDictionary/findCityList?token="+o+"&provinceId="+a,function(e){console.log(e);for(var t=0;t<e.bizData.length;t++)$("#dep_city").append('<option value="'+e.bizData[t].id+'">'+e.bizData[t].cityName+"</option>")});break;case 3:a+="00",$("#dep_county_from").show(),$("#dep_provinces_from,#dep_city_from,#products1-control,#products2-control,#products3-control").hide(),$.getJSON("/system/dataDictionary/findCountyList?token="+o+"&cityId="+a,function(e){console.log(e);for(var t=0;t<e.bizData.length;t++)$("#dep_county").append('<option value="'+e.bizData[t].id+'">'+e.bizData[t].countyName+"</option>")})}},buttons:[{text:"新增","class":"btn btn-primary single-buttons",click:function(){var t=e("static/scripts/index/dep/dep_form");t.validate(function(e){l(e,function(t){if(p.fnDraw(),"0000000"===t.rtnCode){var o=JSON.parse($.cookie("userInfo"));if("-1"==o.departmentCode){var i={id:t.bizData.departmentCode,name:e[0]};a({type:"add",obj:i})}$("#add_dep").dialog("destroy")}else $("#add_dep").dialog("destroy"),r({title:"温馨提示",msg:t.msg,type:"alert",clickHandle:function(){window.location.href="login.html"}})})})}},{text:"取消","class":"btn btn-primary",click:function(){$("#add_dep").dialog("destroy")}}]})})})},update:function(t){$("#"+t).off("click"),$("#"+t).on("click",function(){if(p){var t=i.fnGetSelected(p);if(0!==t.length){var a=p.fnGetData(t[0]);$.get("/system/department/getDepartment?id="+a.id+"&token="+o,function(t){console.log(t),"0000000"===t.rtnCode&&$.get("../tmpl/dep/dep_form.html",function(i){e("sea-modules/jquery/dialog/jquery.dialog"),$("#add_dep").dialog({title:"修改代理商",tmpl:i,onClose:function(){$("#add_dep").dialog("destroy")},render:function(){$("#dep_name").attr("departmentId",t.bizData.id),$("#dep_name").val(t.bizData.departmentName),$("#dep_telephone").val(t.bizData.departmentPhone),$("#dep_fax").val(t.bizData.departmentFax),$("#dep_leading").val(t.bizData.departmentPrincipal),$("#sale_Price").val(t.bizData.salePrice),$("#goods_Address").val(t.bizData.goodsAddress);var e=parseInt(t.bizData.roleType),a=t.bizData.areaCode;console.log(a);for(var r=0;r<t.bizData.products.length;r++)1==t.bizData.products[r].productId&&($("#products1-purchases").val(t.bizData.products[r].pickupPrice),$("#products1-price").val(t.bizData.products[r].salePrice)),2==t.bizData.products[r].productId&&($("#products3-purchases").val(t.bizData.products[r].pickupPrice),$("#products3-price").val(t.bizData.products[r].salePrice)),3==t.bizData.products[r].productId&&($("#products2-purchases").val(t.bizData.products[r].pickupPrice),$("#products2-price").val(t.bizData.products[r].salePrice));switch(e){case 2:$("#dep_provinces_from").show(),$("#dep_city_from,#dep_county_from").hide(),$.getJSON("/system/dataDictionary/findProvinceList?token="+o,function(e){console.log(e);for(var t=0;t<e.bizData.length;t++)$("#dep_provinces").append('<option value="'+e.bizData[t].id+'">'+e.bizData[t].provinceName+"</option>");$("#dep_provinces").find('option[value="'+a+'0000"]').attr("selected",!0)});break;case 3:var i=a.substring(0,2)+"0000";$("#dep_city_from").show(),$("#dep_provinces_from,#dep_county_from,#products1-control,#products2-control,#products3-control").hide(),$.getJSON("/system/dataDictionary/findCityList?token="+o+"&provinceId="+i,function(e){console.log(e);for(var t=0;t<e.bizData.length;t++)$("#dep_city").append('<option value="'+e.bizData[t].id+'">'+e.bizData[t].cityName+"</option>");$("#dep_city").find('option[value="'+a+'00"]').attr("selected",!0)});break;case 4:var d=a.substring(0,4)+"00";$("#dep_county_from").show(),$("#dep_provinces_from,#dep_city_from,#products1-control,#products2-control,#products3-control").hide(),$.getJSON("/system/dataDictionary/findCountyList?token="+o+"&cityId="+d,function(e){console.log(e);for(var t=0;t<e.bizData.length;t++)$("#dep_county").append('<option value="'+e.bizData[t].id+'">'+e.bizData[t].countyName+"</option>")})}},buttons:[{text:"修改","class":"btn btn-primary",click:function(){var t=e("static/scripts/index/dep/dep_form");t.validate(function(e){u(e,function(e){p.fnDraw(),"0000000"===e.rtnCode?$("#add_dep").dialog("destroy"):($("#add_dep").dialog("destroy"),r({title:"温馨提示",msg:e.msg,type:"alert",clickHandle:function(){window.location.href="login.html"}}))},a.id)})}},{text:"取消","class":"btn btn-primary",click:function(){$("#add_dep").dialog("destroy")}}]})})})}}})},"delete":function(e){$("#"+e).off("click"),$("#"+e).on("click",function(){if(p){var e=i.fnGetSelected(p);if(0!==e.length){var t=p.fnGetData(e[0]),d="确认删除代理商"+t.departmentName;r({title:"温馨提示",msg:d,type:"alert",clickHandle:function(){$.get("/system/department/delDepartment?id="+t.id+"&token="+o,function(e){"0000000"===e.rtnCode?(p.fnDraw(),a({type:"delete",id:t.departmentCode})):r({title:"错误提示",msg:e.msg,type:"alert"})})}})}}})}};e.async(["static/scripts/index/renderResource"],function(e){e(m,o)})}});