<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="cn.thinkjoy.zgk.zgksystem.dao.ex.IEXDepartmentDAO">

    <sql id="Base_Column_List">
        id,
        areaCode,
        roleType,
        wechatPrice,
        webPrice,
        salePrice,
        goodsAddress,
        departmentCode,
        companyCode,
        parentCode,
        departmentPhone,
        departmentFax,
        departmentPrincipal,
        departmentName,
        status,
        seqSort,
        description,
        creator,
        createDate,
        lastModDate,
        lastModifier
    </sql>

    <!-- 根据地区编码查询部门集合 -->
    <select id="queryDepartmentsByAreaCode" parameterType="map" resultType="Department">
        SELECT
        <include refid="Base_Column_List" />
        FROM k12system_department WHERE
        areaCode like CONCAT(#{areaCode} , '%')
        and roleType > 1
        LIMIT #{index},#{pageSize}
    </select>

    <!-- 根据地区编码查询部门个数 -->
    <select id="getDepartmentCountByAreaCode" parameterType="map" resultType="Integer">
        SELECT
        count(*)
        FROM k12system_department
        WHERE
          areaCode like CONCAT(#{areaCode} , '%')
          and roleType > 1
    </select>

    <!-- 根据区域编码修改部门信息 -->
    <update id="updateDepartmentInfoByAreaCode" parameterType="map">
        update k12system_department
        set webPrice = #{webPrice},
         wechatPrice = #{wechatPrice}
        where
            areaCode like CONCAT(#{areaCode} , '%')
    </update>

</mapper>

